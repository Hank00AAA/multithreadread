# multithreadread
多线程读文件， 之前听到面试题：多线程读文件，遂实现了一把。

# 实现描述
思路很简单，就是通过读文件属性来获取文件大小，然后把文件分割为不同的部分写到buffer里。因为不同线程写不同的位置，因此不用加锁。多线程读文件速度能否有提升，取决于内存拷贝速度和io。如果io很快，瓶颈在cpu，多线程切换上下文反而会拖慢速度。相反如果在等io，那么多线程可以利用等待io的时间把数据拷贝到buff里，实际上节省了拷贝的时间。

提供了一个简单的go程序来产生测试用例，根据输入的loop数量循环生成a-z，结果是26 * 2 ^ (loop)byte。

# 可优化的地方
### 1. read系统调用参数优化
apue提到过，操作系统读n个字节（4096？）会快一点。或者改用mmap，应该也可以快一点。

### 2. 测试数据可能不准确
因为没有用到屏障，计算了线程创建的时间，其实可以等所有线程都创建了，再开始释放屏障开始计算时间。

### 3. 代码结构有改善空间
代码写得不够漂亮，不过作为demo，也足够了。